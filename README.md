# SimpleMove
PyTorch implementation of mobility prediction by LSTM.

# Datasets
All datasets are open-source:
- Foursquare-NYC(2. NYC and Tokyo Check-in Dataset) https://sites.google.com/site/yangdingqi/home/foursquare-dataset
    - dataset_TSMC2014_NYC.txt: Raw data.
    - foursquare.pk: From other open-source code datasets.
    - foursquare_new.pk: Generated by ./preporcess/preprocess_foursquare.py based on dataset_TSMC2014_NYC.txt

- Porto Taxi https://www.kaggle.com/c/pkdd-15-predict-taxi-service-trajectory-i/data
  - porto_checkin.txt: Generated by ./preporcess/dataprocess.ipynb based on raw data.
  - proto.pk: Generated by ./preporcess/preprocess_porto.py based on porto_checkin.txt.

The processed foursquare dataset has been attached to the data folder. 

Please download the processed Porto dataset as follows:
https://drive.google.com/file/d/1mowt9BbYuEC07K0W90liah-8zjqMOH5h/view?usp=sharing


# Requirements
- Python 3.8.0
- Pytorch 1.7.0
- Numpy 1.24.3

# Project Structure
- train.py
- /data # preprocessed Foursquare and Proto data (pickle file)
- /resutls # the default save path when training the model

# Usage
1. Train a new model:

   Foursquare dataset:
> ```python
> python train.py --data_name 'foursquare'
> ```
   Porto dataset:
> ```python
> python train.py --data_name 'porto'
> ```

Other parameters (refer to train.py):
- for training: 
    - learning_rate, lr_step, lr_decay, L2, clip, epoch_max, dropout_p
- model definition: 
    - loc_emb_size, uid_emb_size, tim_emb_size, hidden_size

